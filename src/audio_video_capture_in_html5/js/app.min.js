var AJAXIFY_SITE=false;function shiftWatermark(){setTimeout(function(){$(".watermark").css("top","30px")},1000)}$(".main nav").on("click","ul li a",function(){$(".main nav .current").removeClass("current");if(AJAXIFY_SITE){$(this).addClass("current")}shiftWatermark()});$(".subheader.features").on("click","ul li a",function(){$(".main nav .current").removeClass("current");shiftWatermark()});function finishPanelLoad(b,a){$(".page").removeClass("current");b.addClass("current");$.scrollTo(b,600,{queue:true,offset:{top:-60,left:0},onAfter:function(){$(".subheader.features").slideUp("fast",function(){if(a.popped!=="popped"){state.push(a)}route.init(page)})}})}$(document).keydown(function(a){if(a.keyCode===27){$("#search_hide, #features_hide").click();$(".outline_nav_toggle").removeClass("activated").find("nav.outline").fadeOut("fast")}});if(AJAXIFY_SITE){$("a").click(function(){if($(this).attr("target")){return true}if(!Modernizr.history){return true}loadContent(this);return false})}function loadContent(c,b){window.page=c.pathname.replace(/\/\w{2,3}\//gi,"").replace(/\/([A-Za-z]+)/gi,"-$1").replace(/(\/$)|(^-)/g,"").split("#")[0];window.pagePanel=$(".page#"+page);var a=c.href;var d=a.split("#")[1];var f={href:a,hash:d,popped:b,title:page[0].toUpperCase()+page.substring(1)};if(page==""){location.href="/";return false}$("body").attr("data-href",page);if(d){var e=pagePanel.find("."+d);if(e.length){finishPanelLoad(e,f)}return false}if(pagePanel.hasClass("loaded")){finishPanelLoad(pagePanel,f)}else{pagePanel.addClass("loaded").load(a+" [data-import-html]",function(){finishPanelLoad(pagePanel,f)})}}$(".outline_nav_toggle").click(function(a){$(this).toggleClass("activated");$(this).find("nav.outline").fadeToggle("fast")});$("nav.features_outline").on("click","a.section_title",function(a){if($(this).parent("li").hasClass("current")){$(this).parent("li").removeClass("current");$(this).siblings("ul").slideUp("fast")}else{$("nav.features_outline li").removeClass("current");$("nav.features_outline a.section_title").siblings("ul").slideUp("fast");$(this).parent("li").addClass("current");$(this).siblings("ul").slideDown("fast")}a.stopPropagation()});window.route={common:function(){},home:function(){},tutorials:function(){},features:function(){window.loadFeaturePanels&&loadFeaturePanels()},init:function(b){var a=route[(b||"").split("-")[0]],c=route[b];route.state=b;route.fire(route.common);route.fire(a);if(c!=a){route.fire(c)}},fire:function(a){if(typeof a=="function"){a.call(route)}},onload:function(){$("nav.outline.features").on("click","ul li ul li a",function(b){var a=this.href.split("#")[1];if(a){$.scrollTo("#"+a,800,{offset:{top:-35}})}});route.init(document.body.getAttribute("data-href"))}};window.state={push:function(a){if(!Modernizr.history){return}history.pushState(a,"",a.href);document.title="HTML5 Rocks - "+a.title},popstate:function(b){if(!(b&&b.state)){return}var a=document.createElement("a");a.href=b.state.href;document.title="HTML5 Rocks - "+b.state.title;loadContent(a,"popped")},handleEvent:function(a){state[a.type].call(state,a)}};$.ajaxPrefilter(function(b,g,c){if(!Modernizr.localstorage||!b.localCache){return}var f=b.cacheTTL||5;var e=b.cacheKey||b.url.replace(/jQuery.*/,"")+b.type+b.data;if(b.isCacheValid&&!b.isCacheValid()){localStorage.removeItem(e)}var a=localStorage.getItem(e+"cachettl");if(a&&a<+new Date()){localStorage.removeItem(e);localStorage.removeItem(e+"cachettl");a="expired"}var d=localStorage.getItem(e);if(d){if(d.indexOf("{")===0){d=JSON.parse(d)}b.success(d);c.abort()}else{if(b.success){b.realsuccess=b.success}b.success=function(i){var h=i;if(this.dataType.indexOf("json")===0){h=JSON.stringify(i)}localStorage.setItem(e,h);if(b.realsuccess){b.realsuccess(i)}};if(!a||a==="expired"){localStorage.setItem(e+"cachettl",+new Date()+1000*60*60*f)}}});if(AJAXIFY_SITE){window.addEventListener("popstate",state,false)}window.addEventListener("DOMContentLoaded",route.onload,false);